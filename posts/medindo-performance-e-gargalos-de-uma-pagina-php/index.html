<!DOCTYPE html>
<html lang="pt-br">
	<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta property="fb:app_id" content="194513401446491"/>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Rafael Santos">

<meta name="generator" content="Hugo 0.55.6" />
<title>Medindo performance e gargalos de uma página PHP com KCacheGrind &#43; XDebug &middot; /dev/ser</title>
<link rel="shortcut icon" href="https://devser.com.br/images/favicon.ico">
<link rel="stylesheet" href="https://devser.com.br/css/style.css">
<link rel="stylesheet" href="https://devser.com.br/css/highlight.css">

<link rel="stylesheet" href="https://devser.com.br/css/custom-styles.css">



<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">




<meta property="og:title" content="Medindo performance e gargalos de uma página PHP com KCacheGrind &#43; XDebug" />
<meta property="og:description" content="Introdução  &ldquo;Conheces teu inimigo e conhece-te a ti mesmo&rdquo; — Sun Tzu (a.k.a “Conheça o gargalo de seu script e atue para otimizá-lo&rdquo;)
 Utilizando KCacheGrind &#43; XDebug no PHP, podemos medir quais métodos de um script são os principais “inimigos&rdquo; de tempo de processamento, o gargalo da execução.
Normalmente, das centenas de métodos que são chamados em um único script, pouquíssimos deles são responsáveis por mais de 90% do processamento, portanto pequenos ajustes nos lugares certos fazem uma grande diferença no tempo de resposta do seu script." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://devser.com.br/posts/medindo-performance-e-gargalos-de-uma-pagina-php/" />
<meta property="article:published_time" content="2017-04-17T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2017-04-17T00:00:00&#43;00:00"/>



<meta itemprop="name" content="Medindo performance e gargalos de uma página PHP com KCacheGrind &#43; XDebug">
<meta itemprop="description" content="Introdução  &ldquo;Conheces teu inimigo e conhece-te a ti mesmo&rdquo; — Sun Tzu (a.k.a “Conheça o gargalo de seu script e atue para otimizá-lo&rdquo;)
 Utilizando KCacheGrind &#43; XDebug no PHP, podemos medir quais métodos de um script são os principais “inimigos&rdquo; de tempo de processamento, o gargalo da execução.
Normalmente, das centenas de métodos que são chamados em um único script, pouquíssimos deles são responsáveis por mais de 90% do processamento, portanto pequenos ajustes nos lugares certos fazem uma grande diferença no tempo de resposta do seu script.">


<meta itemprop="datePublished" content="2017-04-17T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2017-04-17T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="558">



<meta itemprop="keywords" content="" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Medindo performance e gargalos de uma página PHP com KCacheGrind &#43; XDebug"/>
<meta name="twitter:description" content="Introdução  &ldquo;Conheces teu inimigo e conhece-te a ti mesmo&rdquo; — Sun Tzu (a.k.a “Conheça o gargalo de seu script e atue para otimizá-lo&rdquo;)
 Utilizando KCacheGrind &#43; XDebug no PHP, podemos medir quais métodos de um script são os principais “inimigos&rdquo; de tempo de processamento, o gargalo da execução.
Normalmente, das centenas de métodos que são chamados em um único script, pouquíssimos deles são responsáveis por mais de 90% do processamento, portanto pequenos ajustes nos lugares certos fazem uma grande diferença no tempo de resposta do seu script."/>


    </head>
<body>
    <nav class="primary-nav">
<ul>

<li><a href="https://devser.com.br/categories/blogging/">Blogging</a></li>

<li><a href="https://devser.com.br/categories/criptografia/">Criptografia</a></li>

<li><a href="https://devser.com.br/categories/devops/">Devops</a></li>

<li><a href="https://devser.com.br/categories/linux/">Linux</a></li>

<li><a href="https://devser.com.br/categories/machine-learning/">Machine Learning</a></li>

<li><a href="https://devser.com.br/categories/microcontroladores/">Microcontroladores</a></li>

<li><a href="https://devser.com.br/categories/php-e-db/">PHP e DB</a></li>

<li><a href="https://devser.com.br/categories/python/">Python</a></li>

<li><a href="https://devser.com.br/categories/redes-complexas/">Redes Complexas</a></li>

</ul>
</nav>
<nav class="secondary-nav">
	
        <center><a href='https://devser.com.br/' style="font-size:130%"> <span class="arrow">←</span>Voltar</a></center>
	

	

	
</nav>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

    <section id="wrapper">
        
        
<article class="post">
    <header>
        <h1>Medindo performance e gargalos de uma página PHP com KCacheGrind &#43; XDebug</h1>
        <h2 class="subtitle"></h2>
        <h2 class="headline">
        17
        Abril
        2017
        <br>
        
        </h2>
    </header>
    <section id="post-body">
        

<h1 id="introdução">Introdução</h1>

<blockquote>
<p>&ldquo;Conheces teu inimigo e conhece-te a ti mesmo&rdquo; — Sun Tzu (a.k.a “Conheça o gargalo de seu script e atue para otimizá-lo&rdquo;)</p>
</blockquote>

<p>Utilizando KCacheGrind + XDebug no PHP, podemos medir quais métodos de um script são os principais “inimigos&rdquo; de tempo de processamento, o gargalo da execução.</p>

<p>Normalmente, das centenas de métodos que são chamados em um único script, pouquíssimos deles são responsáveis por mais de 90% do processamento, portanto pequenos ajustes nos lugares certos fazem uma grande diferença no tempo de resposta do seu script. Saber como encontrar esses gargalos é o seu maior aliado na hora de otimizar páginas lentas.</p>

<p>Esse será um treinamento bem simples, onde apenas guiarei a instalação desses 2 softwares via apt-get no Debian, e darei exemplo de utilização dos softwares. Não haverá programação envolvida, e não utilizarei o Docker, para diminuir um pouco a complexidade e poder focar no que realmente interessa.</p>

<h1 id="instalação-do-xdebug">Instalação do XDebug</h1>

<p>Instalar o XDebug para PHP é muito fácil no Debian, já que está disponível no repositório oficial:</p>

<p><code>sudo apt-get install php5-xdebug</code></p>

<h1 id="instalação-do-kcachegrind">Instalação do KCachegrind</h1>

<p>O KCacheGrind também está disponível no repositório oficial, mas infelizmente, esse software necessita de diversas bibliotecas do KDE, que por padrão não estão instaladas em uma distribuição Debian, fazendo com que dezenas de pacotes e centenas de megabytes de dependência sejam baixados e instalados pelo comando a seguir:</p>

<p><code>sudo apt-get install kcachegrind</code></p>

<h1 id="configuração-do-xdebug">Configuração do XDebug</h1>

<p>A configuração do XDebug é realizada via php.ini. Em um artigo anterior do blog (<a href="https://devser.com.br/posts/ferramentas-de-debug-para-desenvolvimento-web-xdebug-developer-tools-console-curl-logs/">Ferramentas de debug para desenvolvimento web: Xdebug + Developer Tools Console + Curl + Logs</a>), aprendemos como configurar o XDebug para debugar interativamente seu script. Hoje, não estamos interessados na função Debug, e sim na função Profile do Xdebug, portanto a configuração é um pouco diferente.</p>

<h2 id="modo-sempre-ativado">Modo sempre ativado</h2>

<p>Quando estamos debugando um único script PHP diretamente pelo terminal, podemos configurar o XDebug no php.ini para gerar sempre um novo relatório de performance.
Nesses casos, adicionaremos a seguinte configuração no arquivo php.ini:</p>

<p><code>xdebug.profiler_enable=1</code></p>

<h2 id="modo-ativação-temporária-gatilho">Modo ativação temporária / gatilho</h2>

<p>Outras vezes, quando estamos testando um script PHP por meio de um navegador de internet, é mais interessante configurar o XDebug em modo gatilho, para que o relatório de performance seja gerado apenas nos requests escolhidos, pois caso contrário, teríamos dificuldade em encontrar os relatórios certos em meio a dezenas de requisições ajax e GET e que muitas vezes são realizadas paralelamente durante o carregamento de uma página simples.</p>

<p><code>xdebug.profiler_enable_trigger=1</code></p>

<p>Além disso, deve ser instalado alguma extensão no navegador de internet para setar um cookie com valor XDEBUG_PROFILE=1 a cada vez que se deseja um novo relatório de performance. A extensão que eu utilizo para o Google Chrome é a Xdebug helper (<a href="https://chrome.google.com/webstore/detail/xdebug-helper/eadndfjplgieldjbigjakmdgkmoaaaoc">https://chrome.google.com/webstore/detail/xdebug-helper/eadndfjplgieldjbigjakmdgkmoaaaoc</a>)</p>

<h1 id="visualização-dos-relatórios-de-performance">Visualização dos relatórios de performance</h1>

<p>O XDebug armazena os relatórios de performance na pasta temporária configurada no php.ini na diretiva sys_temp_dir.
Os arquivos são salvos, por padrão, com a nomenclatura cachegrind.out.*</p>

<p>Para visualizar os relatórios, utilizamos o software KCacheGrind e clicando File -&gt; Open e selecionando o relatório cachegrind.out.* desejado.</p>

<p>Clicando no botão % Relative no menu superior, podemos alternar a exibição entre tempo relativo (percentual) e tempo absoluto (quantidade de milisegundos gastos em cada método).</p>

<p>Clicando sobre o título da coluna Self, temos uma lista ordenadas pelos nossos maiores inimigos, os métodos que mais consomem tempo de execução do nosso script.</p>

<p>Pronto, agora você está pronto para vencer seu inimigo.</p>

    </section>
</article>

<footer id="post-meta" class="clearfix">
    <div>
        <img class="avatar" src="https://devser.com.br/images/avatar.png" style="float: left">
        <span class="dark">Rafael Santos</span>
        <span>Engenheiro Físico (UFSCar) e Mestre em Ciências da Computação (USP). A paixão veio de criança: criou seu primeiro website pessoal em 1999. Trabalha com desenvolvimento de software desde 2006.</span>
    </div>
    <section id="sharing" style="margin-top: 20px">
        <a class="twitter" href="https://twitter.com/intent/tweet?text=https%3a%2f%2fdevser.com.br%2fposts%2fmedindo-performance-e-gargalos-de-uma-pagina-php%2f - Medindo%20performance%20e%20gargalos%20de%20uma%20p%c3%a1gina%20PHP%20com%20KCacheGrind%20%2b%20XDebug "><span class="icon-twitter"> Compartilhe</span></a>

<a class="facebook" href="#" onclick="
    window.open(
      'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),
      'facebook-share-dialog',
      'width=626,height=436');
    return false;"><span class="icon-facebook-rect"> Compartilhe</span>
</a>

    </section>
</footer>

<div id="fb-root"></div>
<script async defer crossorigin="anonymous"
    src="https://connect.facebook.net/pt_BR/sdk.js#xfbml=1&version=v3.3&appId=682823301800780&autoLogAppEvents=1">
</script>
<center>
    <div class="fb-comments"
         data-width="500"
         data-href="https://devser.com.br/posts/medindo-performance-e-gargalos-de-uma-pagina-php/"
    >
    </div>
</center>

<hr/>

<ul id="post-list" class="archive readmore">
    <h3>Outros artigos</h3>

    
    
    
        <li>
            <a href="https://devser.com.br/posts/apresentando-a-moeda-libra/">Apresentando a moeda Libra<aside class="dates">Jun 20 2019</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/hello-world-e-sha256-em-c/">Hello world e SHA-256 em C<aside class="dates">Jun 20 2019</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/como-gerar-uma-senha-aleatoria-no-terminal-do-linux/">Como gerar uma senha aleatória no terminal do Linux<aside class="dates">Jun 18 2019</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/tirando-par-ou-impar-pelo-whatsapp/">Tirando par ou ímpar pelo Whatsapp<aside class="dates">Jun 11 2019</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/investigacao-de-fatores-de-latencia-de-rede-em-um-cluster-kubernetes/">Investigação de fatores de latência de rede em um cluster Kubernetes<aside class="dates">Jun 11 2019</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/defesa-dissertacao-mestrado/">Defesa da Dissertação de Mestrado<aside class="dates">Jun 8 2019</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/migrando-de-wordpress-para-gohugo/">Migrando de Wordpress para Hugo (gohugo)<aside class="dates">Jun 8 2019</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/como-aumentar-o-espaco-da-particao-dev-shm/">Como aumentar o espaço da partição /dev/shm<aside class="dates">Nov 6 2018</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/leitura-de-porta-serial-utilizando-python-e-raspberry-pi/">Leitura de porta serial utilizando Python e Raspberry PI<aside class="dates">Mar 2 2018</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/comunicacao-segura-utilizando-gpg/">Comunicação segura utilizando GPG<aside class="dates">Nov 28 2017</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/deixe-seu-mysql-muito-mais-rapido-rodando-na-memoria-ram/">Deixe seu MySQL muito mais rápido rodando na memória RAM<aside class="dates">May 16 2017</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/aprendizado-de-maquina-com-python-tensor-flow/">Aprendizado de máquina com Python &#43; Tensor Flow<aside class="dates">May 12 2017</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/compilador-para-computador-sap-1/">Compilador para computador SAP-1<aside class="dates">Apr 18 2017</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/criando-plugins-para-a-biblioteca-de-templates-smarty-do-php/">Criando plugins para a biblioteca de templates Smarty do PHP<aside class="dates">Mar 16 2017</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/testes-automatizados-com-selenium-phpunit/">Testes automatizados com Selenium &#43; PHPUnit<aside class="dates">Mar 14 2017</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/ferramentas-de-debug-para-desenvolvimento-web-xdebug-developer-tools-console-curl-logs/">Ferramentas de debug para desenvolvimento web: Xdebug &#43; Developer Tools Console &#43; Curl &#43; Logs<aside class="dates">Feb 21 2017</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/simulando-um-computador-sap-1-simple-as-possible-1/">Simulando um computador SAP-1 (Simple As Possible 1)<aside class="dates">Oct 15 2013</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/diagrama-de-bifurcacao-do-mapa-logistico/">Diagrama de Bifurcação do Mapa Logístico<aside class="dates">Nov 17 2012</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/gerenciador-de-artigos-cientificos/">Gerenciador de Artigos Científicos<aside class="dates">Nov 15 2012</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/relacao-entre-otp-e-mapas-binarios/">Relação entre OTP e Mapas Binários<aside class="dates">Nov 14 2012</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/modelo-da-particula-na-caixa/">Modelo da Partícula na Caixa<aside class="dates">Jun 19 2012</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/criptografia-com-equacoes-de-chua/">Criptografia Com Equações de Chua<aside class="dates">May 11 2012</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/criptografia-com-caos-baptista/">Criptografia com Caos - Baptista<aside class="dates">Apr 1 2012</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/primeira-atividade-pratica-mapa-logistico/">Mapa logístico<aside class="dates">Dec 11 2011</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/historia-da-chave-assimetrica/">História da chave assimétrica<aside class="dates">Dec 11 2011</aside></a>
        </li>
    
        <li>
            <a href="https://devser.com.br/posts/inicio-de-iniciacao-cientifica-em-criptografia/">Início de iniciação científica em criptografia<aside class="dates">Dec 11 2011</aside></a>
        </li>
    
</ul>



        <footer id="footer">
    
        <div id="social">

	
	
    <a class="symbol" href="https://www.facebook.com/rafaelpagliuca">
        <i class="fa fa-facebook"></i>
    </a>
    
    <a class="symbol" href="https://www.github.com/rpagliuca">
        <i class="fa fa-github"></i>
    </a>
    


</div>

    
    <p class="small">
    
        © Copyright 2019 Rafael Santos
    
    </p>
</footer>

    </section>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://devser.com.br/js/main.js"></script>
<script src="https://devser.com.br/js/highlight.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-97834327-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

</body>
</html>
